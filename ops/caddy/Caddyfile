{
	admin off
}

{$PUBLIC_HOST:localhost} {
	encode zstd gzip
	header {
		X-Content-Type-Options nosniff
		X-Frame-Options DENY
		Referrer-Policy no-referrer
		Permissions-Policy "interest-cohort=()"
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
	}
	reverse_proxy agent-runtime:8080
}

{$ADMIN_HOST:admin.localhost} {
	encode zstd gzip
	tls {
		client_auth {
			mode require_and_verify
			trusted_ca_cert_file /etc/caddy/pki/clients-ca.crt
		}
	}
	reverse_proxy agent-runtime:8080
}
